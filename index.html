<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cajamarca Sostenible: Observatorio de Riesgos Urbanos</title>

    <!-- Leaflet CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />

    <!-- Hoja de estilos -->
    <link rel="stylesheet" href="styles.css">
</head>

<body>

    <div id="container">
        <!-- MAPA -->
        <div id="map"></div>

        <!-- PANEL LATERAL -->
        <div id="sidebar">
            <h2>üìä Prioridades de Intervenci√≥n en Cajamarca</h2>

            <div id="kpi-cards">
                <div class="kpi-card">
                    <h4>√Årea de Alto Riesgo:</h4>
                    <p id="kpi-alto">--</p>
                </div>
                <div class="kpi-card">
                    <h4>Vegetaci√≥n Cr√≠tica (NDVI bajo):</h4>
                    <p id="kpi-ndvi">--</p>
                </div>
            </div>

            <!-- M√≥dulo IA -->
            <div id="ai-module" class="chart-container">
                <h4>ü§ñ Predicci√≥n de Riesgo (IA)</h4>
                <label>Modo:
                    <select id="ai-mode">
                        <option value="light">Ligero (regla ponderada)</option>
                        <option value="tfjs">Entrenable (TensorFlow.js)</option>
                    </select>
                </label>
                <div>
                    <label>NDVI: <input id="ai-ndvi" type="range" min="0" max="1" step="0.01" value="0.5"></label>
                    <label>LST (¬∞C): <input id="ai-lst" type="range" min="15" max="45" step="0.1" value="26"></label>
                    <label>Densidad (hab/km¬≤): <input id="ai-den" type="range" min="0" max="10000" step="1"
                            value="500"></label>
                </div>
                <button id="ai-predict">Calcular Predicci√≥n</button>
                <div id="ai-output"></div>
                <hr>
                <div id="ai-train-area" style="display:none;">
                    <p>Entrenamiento local (demo) ‚Äî genera un modelo simple con datos sint√©ticos.</p>
                    <button id="ai-train">Entrenar modelo (demo)</button>
                    <div id="ai-train-output"></div>
                </div>
            </div>

            <!-- Simulaci√≥n Clim√°tica -->
            <div id="climate-module" class="chart-container">
                <h4>üå°Ô∏è Simulaci√≥n de Escenarios Clim√°ticos</h4>
                <label>Escenario:
                    <select id="scenario-select">
                        <option value="rcp26">RCP2.6 (optimista)</option>
                        <option value="rcp45">RCP4.5 (moderado)</option>
                        <option value="rcp85">RCP8.5 (pesimista)</option>
                    </select>
                </label>
                <label>A√±o objetivo:
                    <input id="scenario-year" type="number" min="2025" max="2100" value="2050">
                </label>
                <button id="run-scenario">Ejecutar Proyecci√≥n</button>
                <div id="scenario-output"></div>
            </div>

            <!-- Capa Satelital / FIRMS -->
            <div id="sat-module" class="chart-container">
                <h4>üõ∞Ô∏è Capa Satelital en Tiempo Real</h4>
                <p>FIRMS (NASA): detecciones MODIS/VIIRS en el √°rea visible.</p>
                <label>Tu MAP_KEY FIRMS: <input id="firms-key" type="text" placeholder="MAP_KEY (obligatorio)"></label>
                <button id="toggle-firms">Cargar detecciones FIRMS (vista actual)</button>
                <button id="add-wri-geotiff">Mostrar capa emisiones (WRI - GeoTIFF v√≠a WMS)</button>
                <div id="sat-output"></div>
            </div>



            <div id="wri-info" class="chart-container">
                <p>Cargando informaci√≥n complementaria del WRI...</p>
            </div>

            <!-- NUEVA SECCI√ìN DIN√ÅMICA DE LA API -->
            <div id="wri-datasets" class="chart-container">
                <h4>üåê Datasets disponibles (WRI)</h4>
                <p id="dataset-status">Cargando lista...</p>
                <ul id="dataset-list"></ul>
            </div>

            <hr>

            <h3>Detalle del √Årea Seleccionada</h3>
            <div id="area-info">
                <p>Haz clic en el mapa para ver los datos de LST, NDVI y Densidad de esa zona espec√≠fica.</p>
                <div id="selected-metrics"></div>
            </div>

            <div class="chart-container">
                <canvas id="riskChart"></canvas>
            </div>
        </div>
    </div>

    <!-- Librer√≠as externas -->
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Script principal -->
    <script src="script.js"></script>
</body>

</html>